local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

local function setupWallhop(character)
	local humanoid = character:WaitForChild("Humanoid")
	local hrp = character:WaitForChild("HumanoidRootPart")
	local camera = workspace.CurrentCamera

	-- GUI setup
	local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
	screenGui.Name = "WallhopGui"

	local button = Instance.new("TextButton")
	button.Size = UDim2.new(0, 140, 0, 50)
	button.Position = UDim2.new(0, 10, 1, -60)
	button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	button.TextColor3 = Color3.new(1, 1, 1)
	button.Font = Enum.Font.GothamBold
	button.TextScaled = true
	button.Text = "Wallhop: OFF"
	button.Draggable = true
	button.Active = true
	button.Selectable = true
	button.Parent = screenGui

	local wallhopEnabled = false
	local isWallhopping = false

	button.MouseButton1Click:Connect(function()
		wallhopEnabled = not wallhopEnabled
		button.Text = wallhopEnabled and "Wallhop: ON" or "Wallhop: OFF"
	end)

	RunService.Heartbeat:Connect(function()
		if not wallhopEnabled or isWallhopping then return end

		local footPos = hrp.Position - Vector3.new(0, 2.5, 0)
		local size = Vector3.new(2, 1, 2)
		local region = Region3.new(footPos - size / 2, footPos + size / 2)

		local partsInRegion = workspace:FindPartsInRegion3(region, character, 10)
		local colorSet = {}

		for _, part in pairs(partsInRegion) do
			if part:IsA("BasePart") then
				colorSet[tostring(part.Color)] = true
			end
		end

		local colorCount = 0
		for _ in pairs(colorSet) do
			colorCount += 1
		end

		if colorCount >= 2 then
			isWallhopping = true
			humanoid:ChangeState(Enum.HumanoidStateType.Jumping)

			task.delay(0.1, function()
				isWallhopping = false
			end)
		end
	end)
end

-- Jalankan pertama kali
local char = player.Character or player.CharacterAdded:Wait()
setupWallhop(char)

-- Deteksi respawn
player.CharacterAdded:Connect(function(newChar)
	wait(0.1)
	setupWallhop(newChar)
end)
